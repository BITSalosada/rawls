{
	"apiVersion": "0.1",
	"swaggerVersion": "1.2",
	"basePath": "/",
	"resourcePath": "/workspaces/{workspaceNamespace}/{workspaceName}/submissions",
	"apis": [{
		"path": "/workspaces/{workspaceNamespace}/{workspaceName}/submissions",
		"operations": [
		{
			"method": "GET",
			"summary": "List all submissions",
			"notes": "",
			"type": "Object",
			"nickname": "listSubmissions",
			"produces": ["application/json"],
			"parameters": [{
				"name": "workspaceNamespace",
				"description": "Workspace Namespace",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "workspaceName",
				"description": "Workspace Name",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}],
			"responseMessages": [{
				"code": 200,
				"message": "Successful Request"
			}, {
				"code": 404,
				"message": "Workspace not found"
			}, {
				"code": 500,
				"message": "Rawls Internal Error"
			}]
		},
		{
			"method": "POST",
			"summary": "Create submission",
			"notes": "",
			"type": "Submission",
			"nickname": "createSubmission",
			"produces": ["application/json"],
			"parameters": [{
				"name": "workspaceNamespace",
				"description": "Workspace Namespace",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "workspaceName",
				"description": "Workspace Name",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "submission",
				"description": "Description of a submission.",
				"required": true,
				"type": "SubmissionRequest",
				"paramType": "body",
				"allowMultiple": false
			}],
			"responseMessages": [{
				"code": 201,
				"message": "Successful Request"
			}, {
				"code": 400,
				"message": "Expression eval failed or entities are not of type required by method config"
			}, {
				"code": 404,
				"message": "Method Configuration or Entity not found"
			}, {
				"code": 409,
				"message": "Method Configuration failed to resolve input expressions with the supplied Entity"
			}, {
				"code": 500,
				"message": "Rawls Internal Error"
			}]
		}]
	}, {
		"path": "/workspaces/{workspaceNamespace}/{workspaceName}/submissions/validate",
		"operations": [{
			"method": "POST",
			"summary": "Validate submission",
			"notes": "",
			"type": "SubmissionValidationReport",
			"nickname": "validateSubmission",
			"produces": ["application/json"],
			"parameters": [{
				"name": "workspaceNamespace",
				"description": "Workspace Namespace",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "workspaceName",
				"description": "Workspace Name",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "submission",
				"description": "Description of a submission.",
				"required": true,
				"type": "SubmissionRequest",
				"paramType": "body",
				"allowMultiple": false
			}],
			"responseMessages": [{
				"code": 200,
				"message": "Validation Response"
			},{
				"code": 400,
				"message": "Invalid Request"
			},{
				"code": 404,
				"message": "No Entity"
			}, {
				"code": 500,
				"message": "Rawls Internal Error"
			}]
		}]
	}, {
		"path": "/workspaces/{workspaceNamespace}/{workspaceName}/submissions/{submissionId}",
		"operations": [{
			"method": "GET",
			"summary": "Monitor submission status",
			"notes": "",
			"type": "Submission",
			"nickname": "getSubmissionStatus",
			"produces": ["application/json"],
			"parameters": [{
				"name": "workspaceNamespace",
				"description": "Workspace Namespace",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "workspaceName",
				"description": "Workspace Name",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}, {
				"name": "submissionId",
				"description": "Submission Id",
				"required": true,
				"type": "string",
				"paramType": "path",
				"allowMultiple": false
			}],
			"responseMessages": [{
				"code": 200,
				"message": "Successful Request"
			}, {
				"code": 404,
				"message": "Submission Not Found"
			}, {
				"code": 500,
				"message": "Rawls Internal Error"
			}]
		}, {
            "method": "DELETE",
            "summary": "Abort submission",
            "notes": "",
            "type": "void",
            "nickname": "abortSubmission",
            "produces": ["application/json"],
            "parameters": [{
                "name": "workspaceNamespace",
                "description": "Workspace Namespace",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }, {
                "name": "workspaceName",
                "description": "Workspace Name",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }, {
                "name": "submissionId",
                "description": "Submission Id",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }],
            "responseMessages": [{
                "code": 204,
                "message": "Successful Request"
            }, {
                "code": 404,
                "message": "Submission Not Found"
            }, {
                "code": 500,
                "message": "Rawls Internal Error"
            }]
        }]
	}, {
        "path": "/workspaces/{workspaceNamespace}/{workspaceName}/submissions/{submissionId}/workflows/{workflowId}/outputs",
        "operations": [{
            "method": "GET",
            "summary": "Get workflow outputs",
            "notes": "",
            "type": "WorkflowOutputs",
            "nickname": "getWorkflowOutputs",
            "produces": ["application/json"],
            "parameters": [{
                "name": "workspaceNamespace",
                "description": "Workspace Namespace",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }, {
                "name": "workspaceName",
                "description": "Workspace Name",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }, {
                "name": "submissionId",
                "description": "Submission Id",
                "required": true,
                "type": "string",
                "paramType": "path",
                "allowMultiple": false
            }, {
                 "name": "workflowId",
                 "description": "Workflow Id",
                 "required": true,
                 "type": "string",
                 "paramType": "path",
                 "allowMultiple": false
             }],
            "responseMessages": [{
                "code": 200,
                "message": "Successful Request"
            }, {
                "code": 404,
                "message": "Submission or Workflow Not Found"
            }, {
                "code": 500,
                "message": "Rawls Internal Error"
            }]
        }]
    }],
	"models": {
		"Submission": {
			"id": "Submission",
			"description": "",
			"properties": {
				"submissionId": {
					"type": "string",
					"description": "SubmissionRequest unique identifier"
				},
				"submissionDate": {
					"type": "string",
					"format": "date-time",
					"description": "SubmissionRequest date"
				},
				"submitter": {
					"type": "string",
					"description": "user that created the submission"
				},
				"methodConfigurationNamespace": {
					"type": "string",
					"description": "Method configuration namespace"
				},
				"methodConfigurationName": {
					"type": "string",
					"description": "Method configuration name"
				},
				"entityType": {
					"type": "string",
					"description": "Entity type"
				},
				"entityName": {
					"type": "string",
					"description": "Entity name"
				},
				"workflows": {
					"type": "array",
					"description": "Status of Workflow(s)",
					"items": {
						"$ref": "Workflow"
					}
				},
				"notstarted": {
					"type": "array",
					"description": "Workflows that failed to start",
					"items": {
						"$ref": "WorkflowFailure"
					}
				},
				"status": {
					"$ref": "SubmissionStatus",
					"description": "Status"
				}
			}
		},
		"WorkflowFailure": {
			"id": "WorkflowFailure",
			"description": "",
			"properties": {
				"workspaceNamespace": {
					"type": "string",
					"description": "Workspace namespace"
				},
				"workspaceName": {
					"type": "string",
					"description": "Workspace name"
				},
				"entityName": {
					"type": "string",
					"description": "Entity name"
				},
				"entityType": {
					"type": "string",
					"description": "Entity type"
				},
				"errors": {
					"type": "array",
					"description": "List of errors starting this workflow",
					"items": {
						"type": "string"
					}
				}
			}
		},
		"Workflow": {
			"id": "Workflow",
			"description": "",
			"properties": {
				"workspaceNamespace": {
					"type": "string",
					"description": "Workspace namespace"
				},
				"workspaceName": {
					"type": "string",
					"description": "Workspace name"
				},
				"id": {
					"type": "string",
					"description": "Workflow unique identifier"
				},
				"status": {
					"$ref": "WorkflowStatus",
					"description": "Workflow status"
				},
				"statusLastChangedDate": {
					"type": "string",
					"format": "date-time",
					"description": "Status last-changed date"
				},
				"entityType": {
					"type": "string",
					"description": "Entity type"
				},
				"entityName": {
					"type": "string",
					"description": "Entity name"
				}
			}
		},
		"WorkflowStatus": {
			"id": "WorkflowStatus",
			"properties": {
				"done": {
					"type": "boolean"
				}
			}
		},
		"SubmissionRequest": {
			"id": "SubmissionRequest",
			"description": "",
			"required": ["methodConfigurationNamespace", "methodConfigurationName", "entityType", "entityName"],
			"properties": {
				"methodConfigurationNamespace": {
					"type": "string",
					"description": "Namespace of the method configuration to execute."
				},
				"methodConfigurationName": {
					"type": "string",
					"description": "Name of the method configuration to execute."
				},
				"entityType": {
					"type": "string",
					"description": "Type of root entity for expression."
				},
				"entityName": {
					"type": "string",
					"description": "Name of root entity for expression."
				},
				"expression": {
					"type": "string",
					"description": "Expression that resolves to one or more entities matching the entity type in the method configuration."
				}
			}
		},
		"SubmissionValidationInput": {
			"id": "SubmissionValidationInput",
			"description": "method configuration input parameter, it's name and the associated expression from the method config",
			"required": ["name", "expression"],
			"properties": {
				"wdlName": {
					"type": "string",
					"description": "name of input"
				},
				"expression": {
					"type": "string",
					"description": "expression for input"
				}
			}
		},
		"SubmissionValidationHeader": {
			"id": "SubmissionValidationHeader",
			"description": "common values for all the entities -- the entity type and the input descriptions",
			"required": ["entityType", "inputExpressions"],
			"properties": {
				"entityType": {
					"type": "string",
					"description": "type of entity"
				},
				"inputExpressions": {
					"type": "array",
					"description": "input descriptions",
					"items": { "$ref": "SubmissionValidationInput" }
				}
			}
		},
		"SubmissionValidationValue": {
			"id": "SubmissionValidationValue",
			"description": "result of an expression parse for one of the inputs",
			"required": [],
			"properties": {
				"value": {
					"type": "string",
					"description": "the value of the input expression for the specified entity"
				},
				"error": {
					"type": "string",
					"description": "parsing error(s)"
				}
			}
		},
		"SubmissionValidationEntityInputs": {
			"id": "SubmissionValidationEntityInputs",
			"description": "the results of parsing each of the inputs for one entity",
			"required": ["entityName", "inputResolutions"],
			"properties": {
				"entityName": {
					"type": "string",
					"description": "name of entity"
				},
				"inputResolutions": {
					"type": "array",
					"description": "input resolution",
					"items": { "$ref": "SubmissionValidationValue" }
				}
			}
		},
		"SubmissionValidationReport": {
			"id": "SubmissionValidationReport",
			"description": "the results of parsing each input for each entity",
			"required": ["request", "header", "validEntities", "invalidEntities"],
			"properties": {
				"request": {
					"$ref": "SubmissionRequest",
					"description": "the request data"
				},
				"header": {
					"$ref": "SubmissionValidationHeader",
					"description": "common values for all entities"
				},
				"validEntities": {
					"type": "array",
					"description": "runnable entities",
					"items": { "$ref": "SubmissionValidationEntityInputs" }
				},
				"invalidEntities": {
					"type": "array",
					"description": "non-runnable entities",
					"items": { "$ref": "SubmissionValidationEntityInputs" }
				}
			}
		},
		"WorkflowReport": {
			"id": "WorkflowReport",
			"description": "information on each workflow submitted",
			"required": ["workflowId", "status", "statusLastChangedDate", "entityName", "inputResolutions"],
			"properties": {
				"workflowId": {
					"type": "string",
					"description": "uuid for workflow"
				},
				"status": {
					"$ref": "WorkflowStatus",
					"description": "workflow status"
				},
				"statusLastChangedDate": {
					"type": "string",
					"format": "date-time",
					"description": "date and time of last status change"
				},
				"entityName": {
					"type": "string",
					"description": "name of entity"
				},
				"inputResolutions": {
					"type": "array",
					"description": "resolved values of the input expressions for the method",
					"items": { "$ref": "SubmissionValidationEntityInputs" }
				}
			}
		},
		"SubmissionReport": {
			"id": "SubmissionReport",
			"description": "information on a submission",
			"required": ["request", "submissionId", "submissionDate", "submitter", "status", "header", "workflows", "notstarted"],
			"properties": {
				"request": {
					"$ref": "SubmissionRequest",
					"description": "the request data"
				},
				"submissionId": {
					"type": "string",
					"description": "SubmissionRequest unique identifier"
				},
				"submissionDate": {
					"type": "string",
					"format": "date-time",
					"description": "SubmissionRequest date"
				},
				"submitter": {
					"type": "string",
					"description": "user that created the submission"
				},
				"status": {
					"$ref": "SubmissionStatus",
					"description": "Status"
				},
				"header": {
					"$ref": "SubmissionValidationHeader",
					"description": "common values for all entities"
				},
				"workflows": {
					"type": "array",
					"description": "workflows initiated by this submission",
					"items": { "$ref": "WorkflowReport" }
				},
				"notstarted": {
					"type": "array",
					"description": "entities that could not be used to start workflows",
					"items": { "$ref": "SubmissionValidationEntityInputs" }
				}
			}
		},
        "TaskOutput": {
            "id": "TaskOutput",
            "description": "Outputs from a single task in a workflow",
            "properties": {
                "logs": {
                    "type": "object",
                    "description": "Log messages from this task",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "outputs": {
                    "type": "object",
                    "description": "Outputs from this task"
                }
            }
        },
        "WorkflowOutputs": {
            "id": "WorkflowOutputs",
            "description": "Outputs and logs from all tasks in a workflow",
            "properties": {
                "tasks": {
                    "type": "object",
                    "description": "Map from tasks to output/log pairs",
                    "properties": {
                        "$ref": "TaskOutput"
                    }
                },
                "workflowId": {
                    "type": "string",
                    "description": "The id of this workflow"
                }
            }
        }
	}
}
